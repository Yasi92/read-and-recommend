{% extends "base.html" %}
{% block content %}
{% from "_formhelpers.html" import render_field %}

<div class="row">
    <div class="col s12">
      
        <a class="back-btn" href="#"><i class="fas fa-arrow-alt-circle-left"></i></a>
        <div class="row">
            <div class="col s4 offset-m1 ">
                <img src="{{ book_details.img_url  }}" alt="cover image" class="responsive-img book-img">
            </div>
            <div class="col s6">
                <div class="book_title_div center-align">
                    {% if book_details.best_seller  %}
                    <span class="badge left orange lighten-1"><i class="fas fa-tag"></i> Best Seller</span>
                    {% endif %}
                    <h4>{{ book_details.title|title }}</h4>
                </div>
                <table>
                    <tbody>
                        <tr>
                            <td>Author</td>
                            <td class="right">{{ book_details.author }}</td>
                        </tr>
                        <tr>
                            <td>Publisher:</td>
                            <td class="right">{{ book_details.publisher }}</td>
                        </tr>
                        <tr>
                            <td>Pages:</td>
                            <td class="right">{{ book_details.pages }}</td>
                        </tr>
                        <td>Price:</td>
                        <td class="right">{{ book_details.price }} â‚¬</td>
                        </tr>
                        <tr>
                            <td>Created By:</td>
                            <td class="right">{{ book_details.added_by }}</td>
                        </tr>
                        
                    </tbody>
                </table>
                <div class="center">
                    <a class="waves-effect btn-large center-align wide-btn light-green darken-3 hoverable"
                        target="blank" href="{{ book_details.shopping_link }}">Go Get It</a>
                </div>
                {% if session.user|lower == book_details.added_by|lower %}
                <div class="book-btn">
                    <a class="red btn modal-trigger" href="#modal1">Delete</a>

                    <!-- Modal Structure -->
                    <div id="modal1" class="modal">
                        <div class="modal-content">
                            <h4>Delete "{{ book_details.title|title }}"</h4>
                            <p>Are you sure you want to delete this book?</p>
                        </div>
                        <div class="modal-footer">
                            <a class="btn-small red"
                                href="{{ url_for('get_book', book_id=book_details._id) }}">Cancel</a>
                            <a class="btn-small green"
                                href="{{ url_for('delete_book', book_id=book_details._id) }}">Yes</a> </div>
                    </div>
                    <a class="btn-small light-blue" href="{{ url_for('edit_book', book_id=book_details._id) }}">Edit</a>
                </div>
               
              
            </div>
            {% endif %}
        </div>
    </div>

</div>
</div>

<div class="row">
    <div class="col s10 offset-m1">
        <h4 class="center-align"> About "{{ book_details.title|title }}"</h4>
        <p class="addReadMore showlesscontent">{{ book_details.description }}</p>
    </div>
</div>


<div class="row">


    <div class="col s10 offset-m1 review-box teal lighten-5">
        <div class="heading-div">
            <h4 class="center-align">Tell Us About This Book</h4>
        </div>
        <form class="form" action="{{ url_for('get_book', book_id=book_details._id) }}" method="POST">
            <div class="row">
                <div class="input-field col s8 offset-m2">
                    {{ render_field(review_form.review) }}
                </div>
            </div>
            <div class="row">
                <div class="col s2 offset-m5">
                    <button type="submit" class="col s12 btn-large light-green darken-1">Submit
                        <i class="far fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>


{% if reviews_length > 0  %}
<div class="row">
    <div class="col s10 offset-m1">
        <ul class="collection">
            {% for review in reviews %}
            {% set review_id = review._id %}
            <li class="collection-item-review avatar">
                <div class="row">
                    <div class="col s1 valign-wrapper">
                        <img height="80" width="80" class="responsive-img circle"
                            src="{{ url_for('static', filename='images/images.jpeg') }}" alt="User Profile Image">
                    </div>
                    <div class="col s10">
                        <h6 class="title"> Review By: {{ review.username }}</h6>
                        <blockquote>{{ review.review }}</blockquote>
                    </div>
                    {% if session.user|lower == review.username|lower %}
                        <div class="col s1">
                            <button data-target="modal-{{ review_id }}" class="red btn-small modal-trigger right">Delete</button>
                            <!-- Modal Structure -->
                            <div id="modal-{{ review_id }}" class="modal">
                                <div class="modal-content">
                                    <h4>Delete Review</h4>
                                    <p>Are you sure you want to delete your review about {{ review.book_title|title }}?</p>
                                </div>
                                <div class="modal-footer">
                                    <a class="btn-small red modal-close"
                                        href="#">Cancel</a>
                                        <a href="{{ url_for('delete_review', review_id=review_id) }}" class="btn-small green">Delete</a>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </li>
            {% endfor %}

        </ul>
        <div class="center">
            <button class="btn-large center red loadMoreReview">Load More</button>
        </div>
    </div>
</div>

{% endif %}

{% endblock %}